<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"
                  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
                  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
                  xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
                  xmlns:zeebe="http://camunda.org/schema/zeebe/1.0"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  id="Definitions_ProductPromotion"
                  targetNamespace="http://bpmn.io/schema/bpmn"
                  exporter="Camunda Modeler"
                  exporterVersion="5.0.0">

  <bpmn:process id="ProductPromotionWorkflow" isExecutable="true" name="Product Promotion Workflow (Interactive)">

    <!-- ====================== Start Event ====================== -->
    <bpmn:startEvent id="StartEvent_1" name="Start Promotion Process">
      <bpmn:outgoing>Flow_01</bpmn:outgoing>
    </bpmn:startEvent>

    <!-- ====================== Step 1 – Data & Analysis (Interactive) ====================== -->
    <bpmn:serviceTask id="Task_DataIdentification" name="Detect low-selling or expiring products (generate target list)">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="identify-products" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_01</bpmn:incoming>
      <bpmn:outgoing>Flow_02</bpmn:outgoing>
    </bpmn:serviceTask>

    <!-- ====================== Step 2 – Parallel Split ====================== -->
    <bpmn:parallelGateway id="Gateway_Split" name="Split for Commercial Tasks">
      <bpmn:incoming>Flow_02</bpmn:incoming>
      <bpmn:outgoing>Flow_Proposal</bpmn:outgoing>
      <bpmn:outgoing>Flow_PrepareInStore</bpmn:outgoing>
    </bpmn:parallelGateway>

    <!-- Commercial Task 1: Propose Promotion (Interactive) -->
    <bpmn:serviceTask id="Task_Proposal" name="Propose discount/promotion strategy">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="propose-promotion" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_Proposal</bpmn:incoming>
      <bpmn:outgoing>Flow_Join1</bpmn:outgoing>
    </bpmn:serviceTask>

    <!-- Commercial Task 2: Prepare In-Store Update (Interactive) -->
    <bpmn:serviceTask id="Task_PrepareInStore" name="Prepare in-store price updates">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="prepare-instore-update" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_PrepareInStore</bpmn:incoming>
      <bpmn:outgoing>Flow_Join2</bpmn:outgoing>
    </bpmn:serviceTask>

    <!-- Parallel Join -->
    <bpmn:parallelGateway id="Gateway_Join" name="Join Commercial Tasks">
      <bpmn:incoming>Flow_Join1</bpmn:incoming>
      <bpmn:incoming>Flow_Join2</bpmn:incoming>
      <bpmn:outgoing>Flow_03</bpmn:outgoing>
    </bpmn:parallelGateway>

    <!-- ====================== Step 3 – Finance & Accounting (Interactive) ====================== -->
    <bpmn:serviceTask id="Task_ProfitabilityStudy" name="Evaluate financial feasibility and profitability">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="evaluate-profitability" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_03</bpmn:incoming>
      <bpmn:outgoing>Flow_04</bpmn:outgoing>
    </bpmn:serviceTask>

    <!-- ====================== Decision Gateway ====================== -->
    <bpmn:exclusiveGateway id="Gateway_Approval" name="Promotion approved?">
      <bpmn:incoming>Flow_04</bpmn:incoming>
      <bpmn:outgoing>Flow_Yes</bpmn:outgoing>
      <bpmn:outgoing>Flow_No</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <!-- No path → Promotion refused -->
    <bpmn:endEvent id="End_Refused" name="Promotion refused">
      <bpmn:incoming>Flow_No</bpmn:incoming>
    </bpmn:endEvent>

    <!-- ====================== Step 4 – Marketing (Interactive) ====================== -->
    <bpmn:serviceTask id="Task_MarketingComm" name="Prepare and publish promotion (flyers, digital, in-store)">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="prepare-promotion-material" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_Yes</bpmn:incoming>
      <bpmn:outgoing>Flow_05</bpmn:outgoing>
    </bpmn:serviceTask>

    <!-- ====================== Step 5 – IT (Interactive) ====================== -->
    <bpmn:serviceTask id="Task_SystemUpdate" name="Update promotional prices in POS, ERP, e-commerce, inventory">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="update-system-prices" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_05</bpmn:incoming>
      <bpmn:outgoing>Flow_06</bpmn:outgoing>
    </bpmn:serviceTask>

    <!-- ====================== Step 6 – Commercial (Interactive) ====================== -->
    <bpmn:serviceTask id="Task_InStoreUpdate" name="Physically update price labels on shelves">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="update-physical-prices" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_06</bpmn:incoming>
      <bpmn:outgoing>Flow_07</bpmn:outgoing>
    </bpmn:serviceTask>

    <!-- Successful end -->
    <bpmn:endEvent id="End_Success" name="Promotion live">
      <bpmn:incoming>Flow_07</bpmn:incoming>
    </bpmn:endEvent>

    <!-- ====================== Sequence Flows ====================== -->
    <bpmn:sequenceFlow id="Flow_01" sourceRef="StartEvent_1" targetRef="Task_DataIdentification" />
    <bpmn:sequenceFlow id="Flow_02" sourceRef="Task_DataIdentification" targetRef="Gateway_Split" />
    <bpmn:sequenceFlow id="Flow_Proposal" sourceRef="Gateway_Split" targetRef="Task_Proposal" />
    <bpmn:sequenceFlow id="Flow_PrepareInStore" sourceRef="Gateway_Split" targetRef="Task_PrepareInStore" />
    <bpmn:sequenceFlow id="Flow_Join1" sourceRef="Task_Proposal" targetRef="Gateway_Join" />
    <bpmn:sequenceFlow id="Flow_Join2" sourceRef="Task_PrepareInStore" targetRef="Gateway_Join" />
    <bpmn:sequenceFlow id="Flow_03" sourceRef="Gateway_Join" targetRef="Task_ProfitabilityStudy" />
    <bpmn:sequenceFlow id="Flow_04" sourceRef="Task_ProfitabilityStudy" targetRef="Gateway_Approval" />
    
    <bpmn:sequenceFlow id="Flow_Yes" name="Yes" sourceRef="Gateway_Approval" targetRef="Task_MarketingComm">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=approved = true</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_No" name="No" sourceRef="Gateway_Approval" targetRef="End_Refused">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=approved = false</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <bpmn:sequenceFlow id="Flow_05" sourceRef="Task_MarketingComm" targetRef="Task_SystemUpdate" />
    <bpmn:sequenceFlow id="Flow_06" sourceRef="Task_SystemUpdate" targetRef="Task_InStoreUpdate" />
    <bpmn:sequenceFlow id="Flow_07" sourceRef="Task_InStoreUpdate" targetRef="End_Success" />

  </bpmn:process>

  <!-- ====================== BPMN Diagram Layout ====================== -->
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="ProductPromotionWorkflow">
      
      <bpmndi:BPMNShape id="StartEvent_1_di" bpmnElement="StartEvent_1">
        <dc:Bounds x="152" y="232" width="36" height="36" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="Task_DataIdentification_di" bpmnElement="Task_DataIdentification">
        <dc:Bounds x="240" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="Gateway_Split_di" bpmnElement="Gateway_Split">
        <dc:Bounds x="395" y="225" width="50" height="50" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="Task_Proposal_di" bpmnElement="Task_Proposal">
        <dc:Bounds x="500" y="140" width="100" height="80" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="Task_PrepareInStore_di" bpmnElement="Task_PrepareInStore">
        <dc:Bounds x="500" y="280" width="100" height="80" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="Gateway_Join_di" bpmnElement="Gateway_Join">
        <dc:Bounds x="655" y="225" width="50" height="50" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="Task_ProfitabilityStudy_di" bpmnElement="Task_ProfitabilityStudy">
        <dc:Bounds x="760" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="Gateway_Approval_di" bpmnElement="Gateway_Approval" isMarkerVisible="true">
        <dc:Bounds x="915" y="225" width="50" height="50" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="End_Refused_di" bpmnElement="End_Refused">
        <dc:Bounds x="922" y="352" width="36" height="36" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="Task_MarketingComm_di" bpmnElement="Task_MarketingComm">
        <dc:Bounds x="1020" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="Task_SystemUpdate_di" bpmnElement="Task_SystemUpdate">
        <dc:Bounds x="1180" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="Task_InStoreUpdate_di" bpmnElement="Task_InStoreUpdate">
        <dc:Bounds x="1340" y="210" width="100" height="80" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="End_Success_di" bpmnElement="End_Success">
        <dc:Bounds x="1502" y="232" width="36" height="36" />
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNEdge id="Flow_01_di" bpmnElement="Flow_01">
        <di:waypoint x="188" y="250" />
        <di:waypoint x="240" y="250" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_02_di" bpmnElement="Flow_02">
        <di:waypoint x="340" y="250" />
        <di:waypoint x="395" y="250" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_Proposal_di" bpmnElement="Flow_Proposal">
        <di:waypoint x="420" y="225" />
        <di:waypoint x="420" y="180" />
        <di:waypoint x="500" y="180" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_PrepareInStore_di" bpmnElement="Flow_PrepareInStore">
        <di:waypoint x="420" y="275" />
        <di:waypoint x="420" y="320" />
        <di:waypoint x="500" y="320" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_Join1_di" bpmnElement="Flow_Join1">
        <di:waypoint x="600" y="180" />
        <di:waypoint x="680" y="180" />
        <di:waypoint x="680" y="225" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_Join2_di" bpmnElement="Flow_Join2">
        <di:waypoint x="600" y="320" />
        <di:waypoint x="680" y="320" />
        <di:waypoint x="680" y="275" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_03_di" bpmnElement="Flow_03">
        <di:waypoint x="705" y="250" />
        <di:waypoint x="760" y="250" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_04_di" bpmnElement="Flow_04">
        <di:waypoint x="860" y="250" />
        <di:waypoint x="915" y="250" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_Yes_di" bpmnElement="Flow_Yes">
        <di:waypoint x="965" y="250" />
        <di:waypoint x="1020" y="250" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_No_di" bpmnElement="Flow_No">
        <di:waypoint x="940" y="275" />
        <di:waypoint x="940" y="352" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_05_di" bpmnElement="Flow_05">
        <di:waypoint x="1120" y="250" />
        <di:waypoint x="1180" y="250" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_06_di" bpmnElement="Flow_06">
        <di:waypoint x="1280" y="250" />
        <di:waypoint x="1340" y="250" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="Flow_07_di" bpmnElement="Flow_07">
        <di:waypoint x="1440" y="250" />
        <di:waypoint x="1502" y="250" />
      </bpmndi:BPMNEdge>
      
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
